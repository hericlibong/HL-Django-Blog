{% extends 'base.html' %}
{% load static %}

{% block title %}

<title> {{ post.title }} </title>

{%  endblock %}

{% block content %}

<div class="container">
  <h6 class="post-cat"> {{ post.category }}</h6>
  <article class="post-detail">

    <h1> {{ post.title }} </h1>
    <div class="card">
      {% if post.thumbnail %}
      <img src="{{ post.thumbnail.url }}" alt="l'image de l'article">
      {% endif %}
    </div>

    <div class="post-title">

      {% if user.is_authenticated %}
      <div>
        {% if perms.posts.change_blogposts %}
        <a href="{% url 'edit'  post.slug  %}" style="color:steelblue"> Editer</a>
        {% endif %}
        {% if perms.posts.delete_blogposts %}
        <a href="{% url 'delete' post.slug  %}" style="color:indianred"> supprimer</a>
        {% endif %}
      </div>

      {% endif %}
    </div>

    <div> {{ post.content|safe }} </div>
    <div> {{ post.author }} </div>


  </article>
  <div id="tags-container">
    {% for tag in post.tags.all %}
    <span class="badge text-bg-secondary">{{ tag.name }}</span>
    {% endfor %}
  </div>


  <div>
    <h4> Comments... </h4>

    <div>
        {% if not user.is_authenticated %}
            <p> Vous devez vous connecter pour ajouter un commentaire. </p>
            <a href="{% url 'login' %}"> Se connecter</a> ou <a href="{% url 'signup' %}"> S'inscrire</a>
        {% elif not post.comments.all %}
            <p> Pas encore de commentaire </p>
            <a href="{% url 'post_comment' post.slug %}"> Ã‰crire un commentaire</a>
        {% else %}
            <a href="{% url 'post_comment' post.slug %}"> Ajouter un commentaire</a>
        {% endif %}
    </div>
    <br/><br/><br/>

    {% for comment in post.comments.all %}
    {% if comment.author.profile_photo %}
    <img class="comment-avatar" src="{{ comment.author.profile_photo.url }}" alt="{{ comment.author.username }} Profile Picture" style="width: 10%">
    {% else %}
    <img class="avatar-sample" src="{% static 'images/icon_sample.png' %}" alt="sample" style="width: 5%">
    {% endif %}
    <strong>{{ comment.author.username }} - {{ comment.title }} - {{ comment.created_at }}</strong>
    <br />
    {{ comment.body }}
    <br> <br />
{% endfor %}

</div>


    <br />
  </div>

  {% endblock %}
